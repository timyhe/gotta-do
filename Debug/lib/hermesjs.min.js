var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,s)}a((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){a.label=n[1];break}if(6===n[0]&&a.label<u[1]){a.label=u[1],u=n;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(n);break}u[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,s,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Imagine;!function(e){!function(e){function t(e){return e.protocol+"://"+e.hostname+":"+e.port}function n(e){var t=e.get("Content-Type");return null!==t&&(-1!==t.indexOf("application/json")||-1!==t.indexOf("text/json"))}e.Method={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH",HEAD:"HEAD",OPTIONS:"OPTIONS",CONNECT:"CONNECT"},e.getHostUrl=t,e.sendRequest=function(e,t,r,o,i){return __awaiter(this,void 0,void 0,function(){var u,s,a,c,l;return __generator(this,function(f){switch(f.label){case 0:return r||(r=JSON),u=t(e.url,e),o&&u.then(o),i&&u.catch(function(e){i(e)}),[4,u];case 1:return 204===(s=f.sent()).status?[2,void 0]:404===s.status&&"GET"===e.method?[2,void 0]:[4,s.text()];case 2:a=f.sent(),c=void 0;try{c=n(s.headers)?r.parse(a):a}catch(e){return[2,Promise.reject(e)]}return s.ok?[2,c]:(l={res:c,status:s.status},[2,Promise.reject(l)])}})})},e.isJson=n,e.formatRequest=function(e,t,n){return t||(t=JSON),n&&(e.headers=n),e.body=t.stringify(e.body),e};var r=function(){function n(t){var n=this;this.config=t,this.DEFAULT_PROTOCOL="http",this.DEFAULT_HOSTNAME="localhost",this.DEFAULT_PORT=80,this.DEFAULT_HEADERS={"Content-type":"application/json; charset=UTF-8",Accept:"application/json, text/plain, */*"},this.initialize=function(e){e&&(n.config=e),n.config.endpoint.protocol=n.config.endpoint.protocol||n.DEFAULT_PROTOCOL,n.config.endpoint.hostname=n.config.endpoint.hostname||n.DEFAULT_HOSTNAME,n.config.endpoint.port=n.config.endpoint.port||n.DEFAULT_PORT},this.setCallback=function(e,t){e&&(n.config.successCallback=e),t&&(n.config.errorCallback=t)},this.isJson=function(t){return e.isJson(t)},this.sendRequest=function(t){return __awaiter(n,void 0,void 0,function(){var n;return __generator(this,function(r){return t=this.formatRequest(t),n=this.Fetch,[2,e.sendRequest(t,n,this.JSON,this.config.successCallback)]})})},this.formatRequest=function(t,r){return e.formatRequest(t,n.JSON,r||n.config.defaultHeaders||n.DEFAULT_HEADERS)},this.initialize()}return Object.defineProperty(n.prototype,"baseUrl",{get:function(){return t(this.config.endpoint)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Fetch",{get:function(){return this.config.fetchOverride?this.config.fetchOverride.fetch:window.fetch},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"JSON",{get:function(){return this.config.jsonOverride?this.config.jsonOverride:JSON},enumerable:!0,configurable:!0}),n}();e.RestyLayer=r}(e.Resty||(e.Resty={}))}(Imagine||(Imagine={}));var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,s)}a((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){a.label=n[1];break}if(6===n[0]&&a.label<u[1]){a.label=u[1],u=n;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(n);break}u[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,s,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Imagine;!function(e){!function(e){var t=function(){return function(e){void 0===e&&(e=!1);var t=this;this.verboseLogging=e,this.version="1.5",this.loadFiles=function(e){for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r],u=t.loadConfigSetting(i);u&&n.push(u)}return Promise.all(n).then(function(t){for(var n={},r=0;r<e.length;r++)e[r].value=t[r],n[e[r].name]=e[r];return n})},this.loadConfigSetting=function(e){return e.location instanceof Array||(e.location=[e.location]),e.value?Promise.resolve(e.value):t.loadFilesFallthrough(e.location).catch(function(t){return e.default?(console.error("Failed to load "+e.name+", using default",e.default,t),Promise.resolve(e.default)):(console.error("Failed to load "+e.name,t),Promise.reject(t+" "+e.name))})},this.loadFilesFallthrough=function(e){return t.loadFileFallthrough(e,0)},this.loadFileFallthrough=function(e,n){if(e&&e.length>0&&n>=0&&n<e.length){var r=e[n],o=function(){return t.loadFileFallthrough(e,n+1)};return function(e){return __awaiter(t,void 0,void 0,function(){var t,n,i;return __generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,e];case 1:return t=u.sent(),this.verboseLogging&&console.log("Attempting to load "+t),[4,window.fetch(t)];case 2:return n=u.sent(),[2,n.ok?n.json():o()];case 3:return i=u.sent(),this.verboseLogging&&console.log("Failed to load "+r,i),[2,o()];case 4:return[2]}})})}(Promise.resolve(r))}return Promise.reject("failed to load")},this.loadFile=function(e){return window.fetch(e).then(function(e){return e.json()},function(t){console.error("Failed to load "+e,t)})},this.mergeTable=function(e,t){for(var n in t){var r=t[n];e[n]=r}return e},this.verboseLogging&&console.log("Imagine Config Loader "+this.version+" instantiated")}}();e.ConfigLoader=t}(e.Hermes||(e.Hermes={}))}(Imagine||(Imagine={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,s)}a((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){a.label=n[1];break}if(6===n[0]&&a.label<u[1]){a.label=u[1],u=n;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(n);break}u[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,s,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Imagine;!function(e){!function(t){var n=e.Resty.Method,r=function(){function e(){}return e.getHostUrl=function(e){return(e.protocol||"http")+"://"+e.hostname+":"+e.port},e.getVersionRequest=function(t){return{method:n.GET,url:e.getHostUrl(t)+"/version"}},e.getIPAddressRequest=function(t){return{method:n.GET,url:e.getHostUrl(t)+"/utility/ipaddress"}},e.getDatabasesRequest=function(t){return{method:n.GET,url:e.getHostUrl(t)+"/api"}},e.createDatabaseRequest=function(t,r){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r}},e.deleteDatabaseRequest=function(t,r){return{method:n.DELETE,url:e.getHostUrl(t)+"/api/"+r}},e.getTablesRequest=function(t,r){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r}},e.createTableRequest=function(t,r,o,i){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o,body:{useOrderIndex:i}}},e.getTableKeysRequest=function(t,r,o){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o}},e.deleteTableRequest=function(t,r,o){return{method:n.DELETE,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o}},e.getTableItemsRequest=function(t,r,o){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items"}},e.insertItemRequest=function(t,r,o,i){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items",body:i}},e.upsertItemRequest=function(t,r,o,i){return{method:n.PUT,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items",body:i}},e.getItemRequest=function(t,r,o,i){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items/"+i}},e.deleteItemRequest=function(t,r,o,i){return{method:n.DELETE,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items/"+i}},e.updateItemRequest=function(t,r,o,i,u){return{method:n.PUT,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/items/"+i,body:u}},e.bulkInsertItemsRequest=function(t,r,o,i){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/bulk-insert",body:{items:i}}},e.bulkUpsertItemsRequest=function(t,r,o,i){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/bulk-upsert",body:{items:i}}},e.bulkDeleteItemsRequest=function(t,r,o,i){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/bulk-delete",body:{keys:i}}},e.getPageRequest=function(t,r,o,i,u){return u||(u=null),{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/query/page",body:{startKey:u,pageSize:i}}},e.dynamicQueryRequest=function(t,r,o,i,u,s,a){return void 0===i&&(i=null),void 0===i&&(u=null),s||(s=null),a||(a=null),{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/tables/"+o+"/query/dynamic",body:{pageNum:i,pageSize:u,whereInject:s,orderbyInject:a}}},e.storedProcedureRequest=function(t,r,o,i,u){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/function/"+o,body:{queryType:i,queryParams:u}}},e.getSpecialKeysRequest=function(t,r,o){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r+"/"+o}},e.getSpecialItemRequest=function(t,r,o,i){return{method:n.GET,url:e.getHostUrl(t)+"/api/"+r+"/"+o+"/"+i}},e.deleteImageRequest=function(t,r,o){return{method:n.DELETE,url:e.getHostUrl(t)+"/api/"+r+"/thumbnails/"+o}},e.insertTextItemRequest=function(t,r,o,i,u){return{method:n.POST,url:e.getHostUrl(t)+"/api/"+r+"/text/"+o,body:{text:i,mimeType:u}}},e.upsertTextItemRequest=function(t,r,o,i,u){return{method:n.PUT,url:e.getHostUrl(t)+"/api/"+r+"/text/"+o,body:{text:i,mimeType:u}}},e.deleteTextItemRequest=function(t,r,o){return{method:n.DELETE,url:e.getHostUrl(t)+"/api/"+r+"/text/"+o}},e.getTextUrl=function(t,n,r){return e.getHostUrl(t)+"/api/"+n+"/text/"+r},e.getFileUrl=function(t,n,r){return e.getHostUrl(t)+"/api/"+n+"/files/"+r},e.getImageUrl=function(t,n,r){return e.getHostUrl(t)+"/api/"+n+"/thumbnails/"+r},e}();t.HermesRest=r;var o=function(e){function t(t){var n=e.call(this,t)||this;return n.sendHermesRequest=function(e){return __awaiter(n,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return[4,this.sendRequest(e)];case 1:t=r.sent();try{n=JSON.parse(t)}catch(n){console.error("Failed to parse response for "+e.url,t)}return[2,n]}})})},n.getVersion=function(){return n.sendHermesRequest(r.getVersionRequest(n.config.endpoint))},n.getIPAddress=function(){return n.sendHermesRequest(r.getIPAddressRequest(n.config.endpoint))},n.getDatabases=function(){return n.sendHermesRequest(r.getDatabasesRequest(n.config.endpoint))},n.createDatabase=function(e){return n.sendHermesRequest(r.createDatabaseRequest(n.config.endpoint,e))},n.deleteDatabase=function(e){return n.sendHermesRequest(r.deleteDatabaseRequest(n.config.endpoint,e))},n.getTables=function(e){return n.sendHermesRequest(r.getTablesRequest(n.config.endpoint,e))},n.createTable=function(e,t,o){return void 0===o&&(o=!0),n.sendHermesRequest(r.createTableRequest(n.config.endpoint,e,t,o))},n.getTableKeys=function(e,t){return n.sendHermesRequest(r.getTableKeysRequest(n.config.endpoint,e,t))},n.deleteTable=function(e,t){return n.sendHermesRequest(r.deleteTableRequest(n.config.endpoint,e,t))},n.getTableItems=function(e,t){return n.sendHermesRequest(r.getTableItemsRequest(n.config.endpoint,e,t))},n.insertItem=function(e,t,o){return n.sendHermesRequest(r.insertItemRequest(n.config.endpoint,e,t,o))},n.upsertItem=function(e,t,o){return n.sendHermesRequest(r.upsertItemRequest(n.config.endpoint,e,t,o))},n.getItem=function(e,t,o){return n.sendHermesRequest(r.getItemRequest(n.config.endpoint,e,t,o))},n.deleteItem=function(e,t,o){return n.sendHermesRequest(r.deleteItemRequest(n.config.endpoint,e,t,o))},n.updateItem=function(e,t,o,i){return n.sendHermesRequest(r.updateItemRequest(n.config.endpoint,e,t,o,i))},n.bulkInsertItems=function(e,t,o){return n.sendHermesRequest(r.bulkInsertItemsRequest(n.config.endpoint,e,t,o))},n.bulkUpsertItems=function(e,t,o){return n.sendHermesRequest(r.bulkUpsertItemsRequest(n.config.endpoint,e,t,o))},n.bulkDeleteItems=function(e,t,o){return n.sendHermesRequest(r.bulkDeleteItemsRequest(n.config.endpoint,e,t,o))},n.getPage=function(e,t,o,i){return n.sendHermesRequest(r.getPageRequest(n.config.endpoint,e,t,o,i))},n.dynamicQuery=function(e,t,o,i,u,s){return n.sendHermesRequest(r.dynamicQueryRequest(n.config.endpoint,e,t,o,i,u,s))},n.storedProcedureQuery=function(e,t,o){return n.sendHermesRequest(r.storedProcedureRequest(n.config.endpoint,e,t,"query",o))},n.storedProcedureScalar=function(e,t,o){return n.sendHermesRequest(r.storedProcedureRequest(n.config.endpoint,e,t,"scalar",o))},n.storedProcedureNonQuery=function(e,t,o){return n.sendHermesRequest(r.storedProcedureRequest(n.config.endpoint,e,t,"nonquery",o))},n.getImageKeys=function(e){return n.sendHermesRequest(r.getSpecialKeysRequest(n.config.endpoint,e,"thumbnails"))},n.getImageUrl=function(e,t){return r.getImageUrl(n.config.endpoint,e,t)},n.deleteImage=function(e,t){return n.sendHermesRequest(r.deleteImageRequest(n.config.endpoint,e,t))},n.getTextUrl=function(e,t){return r.getTextUrl(n.config.endpoint,e,t)},n.getTextKeys=function(e){return n.sendHermesRequest(r.getSpecialKeysRequest(n.config.endpoint,e,"text"))},n.getTextItem=function(e,t){var o=n.formatRequest(r.getSpecialItemRequest(n.config.endpoint,e,"text",t));return(0,n.Fetch)(o.url,o).then(function(e){var t=e.headers.get("Content-Type");return e.text().then(function(e){return{mimeType:t,text:e}})})},n.insertTextItem=function(e,t,o,i){return n.sendHermesRequest(r.insertTextItemRequest(n.config.endpoint,e,t,o,i))},n.upsertTextItem=function(e,t,o,i){return n.sendHermesRequest(r.upsertTextItemRequest(n.config.endpoint,e,t,o,i))},n.deleteTextItem=function(e,t){return n.sendHermesRequest(r.deleteTextItemRequest(n.config.endpoint,e,t))},n.getFileUrl=function(e,t){return r.getFileUrl(n.config.endpoint,e,t)},n.getFileKeys=function(e){return n.sendHermesRequest(r.getSpecialKeysRequest(n.config.endpoint,e,"files"))},n.DEFAULT_PORT=9872,n.initialize(),n}return __extends(t,e),t}(e.Resty.RestyLayer);t.HermesDataLayer=o}(e.Hermes||(e.Hermes={}))}(Imagine||(Imagine={}));
//# sourceMappingURL=hermesjs.min.js.map
